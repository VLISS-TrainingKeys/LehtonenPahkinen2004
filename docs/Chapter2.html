<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Chapter 2: Basic Sampling Techniques</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">VLISS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Chapter2.html">Chapter 2</a>
</li>
<li>
  <a href="Chapter3.html">Chapter 3</a>
</li>
<li>
  <a href="Chapter4.html">Chapter 4</a>
</li>
<li>
  <a href="Chapter5.html">Chapter 5</a>
</li>
<li>
  <a href="Chapter6.html">Chapter 6</a>
</li>
<li>
  <a href="Chapter7.html">Chapter 7</a>
</li>
<li>
  <a href="Chapter8.html">Chapter 8</a>
</li>
<li>
  <a href="Chapter9.html">Chapter 9</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Chapter 2: Basic Sampling Techniques</h1>

</div>


<p>In Chapter 2 of the textbook <strong>Practical Methods for Design and
Analysis of Complex Surveys</strong>, Simple random sampling, systematic
sampling and sampling with probability proportional to size are
introduced as the basic sampling techniques. The estimation of three
different population parameters (population total, ratio and median) is
examined. A small fixed population – the Province’91 population - is
used throughout to illustrate the estimation methods, where the main
focus is on the derivation of appropriate sampling weights under each
sampling technique. Special efforts are made in comparing the relative
performances of the estimators (in terms of their standard errors) and
the available information on the structure of the population is
increasingly utilized. The use of such auxiliary information is
considered for two purposes: the sampling design and the estimation of
parameters for a given sampling design.</p>
<p>In <strong>Training Key 28</strong>, SRSWOR sampling is demonstrated
by first reproducing the results of Example 2.1. Then, the SRSWOR
estimation procedure is extended to samples with different sample sizes.
Finally, the performance of SRSWOR estimators is examined by using Monte
Carlo simulation methods.</p>
<p>In <strong>Training Key 45</strong>, intra-class correlation is
demonstrated under systematic sampling. First, the results of Example
2.4 are reproduced. Then, intra-class correlation is examined for
systematic sampling under varying sorting orders of the population.</p>
<p>In <strong>Training Key 54</strong>, PPS sampling is demonstrated by
first reproducing the results of Example 2.6. Then, PPS sampling is
examined in more detail by incorporating different types of auxiliary
data into the estimation procedure.</p>
<!-- NOTE: Instructions for the use of Training Keys are given in the Instructions section. -->
<div id="the-province91-population" class="section level1">
<h1>2.2 The Province’91 population</h1>
<p><a href="Datat/province91.sas7bdat">Download SAS data</a> |
<a href="Datat/Province91.sav">Download SPSS data</a> |
<a href="Datat/Province91.xls">Download Excel file</a> |
<a href="Datat/Province91.txt">Download text file</a></p>
<pre class="r"><code>install.packages(&quot;tidyverse&quot;)
library(tidyverse)
province91 &lt;- tribble(
  ~Stratum, ~Cluster, ~Id, ~Municipality, ~POP91, ~LAB91, ~UE91, ~HOU85, ~URB85,
  #-------|---------|----|--------------|-------|-------|------|-------|-------
  1, 1, 1, &quot;Jyväskylä&quot;, 67200, 33786, 4123, 26881, 1,
  1, 2, 2, &quot;Jämsä&quot;, 12907, 6016, 666, 4663, 1,
  1, 2, 3, &quot;Jämsänkoski&quot;, 8118, 3818,   528, 3019, 1,
  1, 2, 4, &quot;Keuruu&quot;, 12707, 5919,   760, 4896, 1,
  1, 3, 5, &quot;Saarijärvi&quot;, 10774, 4930,   721, 3730, 1,
  1, 5, 6, &quot;Suolahti&quot;, 6159, 3022, 457, 2389, 1,
  1, 3, 7, &quot;Äänekoski&quot;, 11595, 5823, 767, 4264, 1,
  2, 5, 8, &quot;Hankasalmi&quot;, 6080, 2594, 391, 2179, 0,
  2, 6, 9, &quot;Joutsa&quot;, 4594, 2069, 194, 1823, 0,
  2, 7, 10, &quot;Jyväskmlk&quot;, 29349, 13727, 1623, 9230, 0,
  2, 4, 11, &quot;Kannonkoski&quot;, 1919, 821, 153, 726, 0,
  2, 4, 12, &quot;Karstula&quot;, 5594, 2521, 341, 1868, 0,
  2, 8, 13, &quot;Kinnula&quot;, 2324, 927, 129, 675, 0,
  2, 8, 14, &quot;Kivijärvi&quot;, 1972, 819, 128, 634, 0,
  2, 3, 15, &quot;Konginkangas&quot;, 1636, 675, 142, 556, 0,
  2, 5, 16, &quot;Konnevesi&quot;, 3453, 1557, 201, 1215, 0,
  2, 1, 17, &quot;Korpilahti&quot;, 5181, 2144, 239, 1793, 0,
  2, 2, 18, &quot;Kuhmoinen&quot;, 3357, 1448, 187, 1463, 0,
  2, 4, 19, &quot;Kyyjärvi&quot;, 1977, 831, 94, 672, 0,
  2, 5, 20, &quot;Laukaa&quot;, 16042, 7218, 874, 4952, 0,
  2, 6, 21, &quot;Leivonmäki&quot;, 1370, 573, 61, 545, 0,
  2, 6, 22, &quot;Luhanka&quot;, 1153, 522, 54, 435, 0,
  2, 7, 23, &quot;Multia&quot;, 2375, 1059, 119, 925, 0,
  2, 1, 24, &quot;Muurame&quot;, 6830, 3024, 296, 1853, 0,
  2, 7, 25, &quot;Petäjävesi&quot;, 3800, 1737, 262, 1352, 0,
  2, 8, 26, &quot;Pihtipudas&quot;, 5654, 2543, 331, 1946, 0,
  2, 4, 27, &quot;Pylkönmäki&quot;, 1266, 545, 98, 473, 0,
  2, 3, 28, &quot;Sumiainen&quot;, 1426, 617, 79, 485, 0,
  2, 1, 29, &quot;Säynätsalo&quot;, 3628, 1615, 166, 1226, 0,
  2, 6, 30, &quot;Toivakka&quot;, 2499, 1084, 127, 834, 0,
  2, 7, 31, &quot;Uurainen&quot;, 3004, 1330, 219, 932, 0,
  2, 8, 32, &quot;Viitasaari&quot;, 8641, 4011, 568, 3119, 0
)
# save the population data for future use
save(province91, file=&quot;province91.RData&quot;)
# to download the population data use:
load(file=&quot;province91.RData&quot;)</code></pre>
<p><strong>Variables:</strong></p>
<ul>
<li>Stratum = Stratum identification 1=Urban, 2=Rural</li>
<li>Cluster = Cluster identification</li>
<li>Id = ID key</li>
<li>Municipality = Name of municipality</li>
<li>POP91 = Population in 1991 (Official statistics)</li>
<li>LAB = Labour force in 1991 (Official statistics)</li>
<li>UE91 = Unemployed in 1991 (Official statistics)</li>
<li>HOU85 = Households in 1985 (Population Census)</li>
<li>URB85 = Urbanicity in 1985 1= Urban, 0=Rural (Population
Census)</li>
</ul>
<table>
<caption>THE PROVINCE91 POPULATION</caption>
<thead>
<tr class="header">
<th align="right">Stratum</th>
<th align="right">Cluster</th>
<th align="right">Id</th>
<th align="left">Municipality</th>
<th align="right">POP91</th>
<th align="right">LAB91</th>
<th align="right">UE91</th>
<th align="right">HOU85</th>
<th align="right">URB85</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Jyväskylä</td>
<td align="right">67200</td>
<td align="right">33786</td>
<td align="right">4123</td>
<td align="right">26881</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">Jämsä</td>
<td align="right">12907</td>
<td align="right">6016</td>
<td align="right">666</td>
<td align="right">4663</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">Jämsänkoski</td>
<td align="right">8118</td>
<td align="right">3818</td>
<td align="right">528</td>
<td align="right">3019</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="left">Keuruu</td>
<td align="right">12707</td>
<td align="right">5919</td>
<td align="right">760</td>
<td align="right">4896</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">Saarijärvi</td>
<td align="right">10774</td>
<td align="right">4930</td>
<td align="right">721</td>
<td align="right">3730</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left">Suolahti</td>
<td align="right">6159</td>
<td align="right">3022</td>
<td align="right">457</td>
<td align="right">2389</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">7</td>
<td align="left">Äänekoski</td>
<td align="right">11595</td>
<td align="right">5823</td>
<td align="right">767</td>
<td align="right">4264</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="left">Hankasalmi</td>
<td align="right">6080</td>
<td align="right">2594</td>
<td align="right">391</td>
<td align="right">2179</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">9</td>
<td align="left">Joutsa</td>
<td align="right">4594</td>
<td align="right">2069</td>
<td align="right">194</td>
<td align="right">1823</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="left">Jyväskmlk</td>
<td align="right">29349</td>
<td align="right">13727</td>
<td align="right">1623</td>
<td align="right">9230</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">11</td>
<td align="left">Kannonkoski</td>
<td align="right">1919</td>
<td align="right">821</td>
<td align="right">153</td>
<td align="right">726</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">12</td>
<td align="left">Karstula</td>
<td align="right">5594</td>
<td align="right">2521</td>
<td align="right">341</td>
<td align="right">1868</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="left">Kinnula</td>
<td align="right">2324</td>
<td align="right">927</td>
<td align="right">129</td>
<td align="right">675</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">14</td>
<td align="left">Kivijärvi</td>
<td align="right">1972</td>
<td align="right">819</td>
<td align="right">128</td>
<td align="right">634</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">15</td>
<td align="left">Konginkangas</td>
<td align="right">1636</td>
<td align="right">675</td>
<td align="right">142</td>
<td align="right">556</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">16</td>
<td align="left">Konnevesi</td>
<td align="right">3453</td>
<td align="right">1557</td>
<td align="right">201</td>
<td align="right">1215</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">17</td>
<td align="left">Korpilahti</td>
<td align="right">5181</td>
<td align="right">2144</td>
<td align="right">239</td>
<td align="right">1793</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">18</td>
<td align="left">Kuhmoinen</td>
<td align="right">3357</td>
<td align="right">1448</td>
<td align="right">187</td>
<td align="right">1463</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="left">Kyyjärvi</td>
<td align="right">1977</td>
<td align="right">831</td>
<td align="right">94</td>
<td align="right">672</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">5</td>
<td align="right">20</td>
<td align="left">Laukaa</td>
<td align="right">16042</td>
<td align="right">7218</td>
<td align="right">874</td>
<td align="right">4952</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">21</td>
<td align="left">Leivonmäki</td>
<td align="right">1370</td>
<td align="right">573</td>
<td align="right">61</td>
<td align="right">545</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">22</td>
<td align="left">Luhanka</td>
<td align="right">1153</td>
<td align="right">522</td>
<td align="right">54</td>
<td align="right">435</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">23</td>
<td align="left">Multia</td>
<td align="right">2375</td>
<td align="right">1059</td>
<td align="right">119</td>
<td align="right">925</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">24</td>
<td align="left">Muurame</td>
<td align="right">6830</td>
<td align="right">3024</td>
<td align="right">296</td>
<td align="right">1853</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">25</td>
<td align="left">Petäjävesi</td>
<td align="right">3800</td>
<td align="right">1737</td>
<td align="right">262</td>
<td align="right">1352</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">26</td>
<td align="left">Pihtipudas</td>
<td align="right">5654</td>
<td align="right">2543</td>
<td align="right">331</td>
<td align="right">1946</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">27</td>
<td align="left">Pylkönmäki</td>
<td align="right">1266</td>
<td align="right">545</td>
<td align="right">98</td>
<td align="right">473</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">28</td>
<td align="left">Sumiainen</td>
<td align="right">1426</td>
<td align="right">617</td>
<td align="right">79</td>
<td align="right">485</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">29</td>
<td align="left">Säynätsalo</td>
<td align="right">3628</td>
<td align="right">1615</td>
<td align="right">166</td>
<td align="right">1226</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">30</td>
<td align="left">Toivakka</td>
<td align="right">2499</td>
<td align="right">1084</td>
<td align="right">127</td>
<td align="right">834</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">31</td>
<td align="left">Uurainen</td>
<td align="right">3004</td>
<td align="right">1330</td>
<td align="right">219</td>
<td align="right">932</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">32</td>
<td align="left">Viitasaari</td>
<td align="right">8641</td>
<td align="right">4011</td>
<td align="right">568</td>
<td align="right">3119</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Use dropdown in scatter plot below to toggle between variables.</p>
<div class="plotly html-widget html-fill-item" id="htmlwidget-93d3474810a89a35c243" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-93d3474810a89a35c243">{"x":{"visdat":{"5432338b135c":["function () ","plotlyVisDat"]},"cur_data":"5432338b135c","attrs":{"5432338b135c":{"y":{},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"type":"scatter","mode":"markers","name":"LAB91","inherit":true},"5432338b135c.1":{"y":{},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"type":"scatter","mode":"markers","name":"HOU85","visible":false,"inherit":true},"5432338b135c.2":{"y":{},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"type":"scatter","mode":"markers","name":"POP91","visible":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Scatter plot: Unemployed in 1991 (UE91) vs. other variables","yaxis":{"domain":[0.10000000000000001,1],"automargin":true,"title":"UE91"},"xaxis":{"domain":[0,1],"automargin":true,"title":"LAB91"},"showlegend":false,"updatemenus":[{"x":0.20000000000000001,"buttons":[{"method":"update","args":[{"visible":[true,false,false]},{"xaxis":{"title":"LAB91"}}],"label":"LAB91"},{"method":"update","args":[{"visible":[false,true,false]},{"xaxis":{"title":"HOU85"}}],"label":"HOU85"},{"method":"update","args":[{"visible":[false,false,true]},{"xaxis":{"title":"POP91"}}],"label":"POP91"}]}],"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[4123,666,528,760,721,457,767,391,194,1623,153,341,129,128,142,201,239,187,94,874,61,54,119,296,262,331,98,79,166,127,219,568],"text":["Id:  1 <br>Municipality: Jyväskylä","Id:  2 <br>Municipality: Jämsä","Id:  3 <br>Municipality: Jämsänkoski","Id:  4 <br>Municipality: Keuruu","Id:  5 <br>Municipality: Saarijärvi","Id:  6 <br>Municipality: Suolahti","Id:  7 <br>Municipality: Äänekoski","Id:  8 <br>Municipality: Hankasalmi","Id:  9 <br>Municipality: Joutsa","Id:  10 <br>Municipality: Jyväskmlk","Id:  11 <br>Municipality: Kannonkoski","Id:  12 <br>Municipality: Karstula","Id:  13 <br>Municipality: Kinnula","Id:  14 <br>Municipality: Kivijärvi","Id:  15 <br>Municipality: Konginkangas","Id:  16 <br>Municipality: Konnevesi","Id:  17 <br>Municipality: Korpilahti","Id:  18 <br>Municipality: Kuhmoinen","Id:  19 <br>Municipality: Kyyjärvi","Id:  20 <br>Municipality: Laukaa","Id:  21 <br>Municipality: Leivonmäki","Id:  22 <br>Municipality: Luhanka","Id:  23 <br>Municipality: Multia","Id:  24 <br>Municipality: Muurame","Id:  25 <br>Municipality: Petäjävesi","Id:  26 <br>Municipality: Pihtipudas","Id:  27 <br>Municipality: Pylkönmäki","Id:  28 <br>Municipality: Sumiainen","Id:  29 <br>Municipality: Säynätsalo","Id:  30 <br>Municipality: Toivakka","Id:  31 <br>Municipality: Uurainen","Id:  32 <br>Municipality: Viitasaari"],"x":[33786,6016,3818,5919,4930,3022,5823,2594,2069,13727,821,2521,927,819,675,1557,2144,1448,831,7218,573,522,1059,3024,1737,2543,545,617,1615,1084,1330,4011],"type":"scatter","mode":"markers","name":"LAB91","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[4123,666,528,760,721,457,767,391,194,1623,153,341,129,128,142,201,239,187,94,874,61,54,119,296,262,331,98,79,166,127,219,568],"text":["Id:  1 <br>Municipality: Jyväskylä","Id:  2 <br>Municipality: Jämsä","Id:  3 <br>Municipality: Jämsänkoski","Id:  4 <br>Municipality: Keuruu","Id:  5 <br>Municipality: Saarijärvi","Id:  6 <br>Municipality: Suolahti","Id:  7 <br>Municipality: Äänekoski","Id:  8 <br>Municipality: Hankasalmi","Id:  9 <br>Municipality: Joutsa","Id:  10 <br>Municipality: Jyväskmlk","Id:  11 <br>Municipality: Kannonkoski","Id:  12 <br>Municipality: Karstula","Id:  13 <br>Municipality: Kinnula","Id:  14 <br>Municipality: Kivijärvi","Id:  15 <br>Municipality: Konginkangas","Id:  16 <br>Municipality: Konnevesi","Id:  17 <br>Municipality: Korpilahti","Id:  18 <br>Municipality: Kuhmoinen","Id:  19 <br>Municipality: Kyyjärvi","Id:  20 <br>Municipality: Laukaa","Id:  21 <br>Municipality: Leivonmäki","Id:  22 <br>Municipality: Luhanka","Id:  23 <br>Municipality: Multia","Id:  24 <br>Municipality: Muurame","Id:  25 <br>Municipality: Petäjävesi","Id:  26 <br>Municipality: Pihtipudas","Id:  27 <br>Municipality: Pylkönmäki","Id:  28 <br>Municipality: Sumiainen","Id:  29 <br>Municipality: Säynätsalo","Id:  30 <br>Municipality: Toivakka","Id:  31 <br>Municipality: Uurainen","Id:  32 <br>Municipality: Viitasaari"],"x":[26881,4663,3019,4896,3730,2389,4264,2179,1823,9230,726,1868,675,634,556,1215,1793,1463,672,4952,545,435,925,1853,1352,1946,473,485,1226,834,932,3119],"type":"scatter","mode":"markers","name":"HOU85","visible":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[4123,666,528,760,721,457,767,391,194,1623,153,341,129,128,142,201,239,187,94,874,61,54,119,296,262,331,98,79,166,127,219,568],"text":["Id:  1 <br>Municipality: Jyväskylä","Id:  2 <br>Municipality: Jämsä","Id:  3 <br>Municipality: Jämsänkoski","Id:  4 <br>Municipality: Keuruu","Id:  5 <br>Municipality: Saarijärvi","Id:  6 <br>Municipality: Suolahti","Id:  7 <br>Municipality: Äänekoski","Id:  8 <br>Municipality: Hankasalmi","Id:  9 <br>Municipality: Joutsa","Id:  10 <br>Municipality: Jyväskmlk","Id:  11 <br>Municipality: Kannonkoski","Id:  12 <br>Municipality: Karstula","Id:  13 <br>Municipality: Kinnula","Id:  14 <br>Municipality: Kivijärvi","Id:  15 <br>Municipality: Konginkangas","Id:  16 <br>Municipality: Konnevesi","Id:  17 <br>Municipality: Korpilahti","Id:  18 <br>Municipality: Kuhmoinen","Id:  19 <br>Municipality: Kyyjärvi","Id:  20 <br>Municipality: Laukaa","Id:  21 <br>Municipality: Leivonmäki","Id:  22 <br>Municipality: Luhanka","Id:  23 <br>Municipality: Multia","Id:  24 <br>Municipality: Muurame","Id:  25 <br>Municipality: Petäjävesi","Id:  26 <br>Municipality: Pihtipudas","Id:  27 <br>Municipality: Pylkönmäki","Id:  28 <br>Municipality: Sumiainen","Id:  29 <br>Municipality: Säynätsalo","Id:  30 <br>Municipality: Toivakka","Id:  31 <br>Municipality: Uurainen","Id:  32 <br>Municipality: Viitasaari"],"x":[67200,12907,8118,12707,10774,6159,11595,6080,4594,29349,1919,5594,2324,1972,1636,3453,5181,3357,1977,16042,1370,1153,2375,6830,3800,5654,1266,1426,3628,2499,3004,8641],"type":"scatter","mode":"markers","name":"POP91","visible":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="training-key-28-analysing-an-srs-sample"
class="section level1">
<h1>TRAINING KEY 28: Analysing an SRS sample</h1>
<div id="introduction" class="section level3">
<h3>INTRODUCTION</h3>
<p>In this Training Key we use the <a
href="concepts/concepts.html">Province’91 data set</a> as a frame
population in analysing an <a href="concepts/concepts.html">SRSWOR</a>
sample. In part A we calculate the SRSWOR estimates for the total of
UE91 (number of unemployed in the province) and for the total of LAB91
(number of work force in the province) and their corresponding standard
errors from the selected sample where sample size is eight <span
class="math inline">\((n=8)\)</span>. In part B, we examine how sample
size affects to the SRSWOR estimates and their standard errors by
selecting different sample sizes. In part C we simulate SRSWOR samples
by using Monte Carlo simulation techniques to examine the behaviour of
the SRSWOR estimator. Part D is the option for interactive analysis.</p>
</div>
<div id="a-analysing-an-srs-sample-from-the-province91-population"
class="section level3">
<h3>A) ANALYSING AN SRS SAMPLE FROM THE PROVINCE’91 POPULATION</h3>
<p>We calculate the SRSWOR (simple random sampling without replacement)
total estimates of UE91 and LAB91, the ratio estimate (UE91/LAB91) and
their corresponding standard error estimates. We use Province’91 data
set as the frame population.</p>
<p><a href="Keys/key28/key28a_9.htm" target="_blank">Start SAS Training
Key</a></p>
<pre class="r"><code># Create a sample including Jyväskylä, Keuruu, Saarijärvi, Konginkangas, Kuhmoinen, Pihtipudas, Toivakka and Uurainen
Sample &lt;- province91[c(1,4,5,15,18,26,30,31), ]
paste(&quot;SRSWOR sample is&quot;)</code></pre>
<pre><code>## [1] &quot;SRSWOR sample is&quot;</code></pre>
<pre class="r"><code>Sample</code></pre>
<pre><code>## # A tibble: 8 × 9
##   Stratum Cluster    Id Municipality POP91 LAB91  UE91 HOU85 URB85
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1       1     1 Jyväskylä    67200 33786  4123 26881     1
## 2       1       2     4 Keuruu       12707  5919   760  4896     1
## 3       1       3     5 Saarijärvi   10774  4930   721  3730     1
## 4       2       3    15 Konginkangas  1636   675   142   556     0
## 5       2       2    18 Kuhmoinen     3357  1448   187  1463     0
## 6       2       8    26 Pihtipudas    5654  2543   331  1946     0
## 7       2       6    30 Toivakka      2499  1084   127   834     0
## 8       2       7    31 Uurainen      3004  1330   219   932     0</code></pre>
<pre class="r"><code>#
# load package survey (to install package use: install.packages(&quot;survey&quot;))
library(survey)
# total=32:  fpc = finite population correction: fpc = (1-n/N)
# This column (variable) fpc simply contains the number 32 for every record
Sample$fpc &lt;- 32
# This variable contains the weights
Sample$weights &lt;- 4
# Construct an object called province91.srs.design specifying a simple random sampling design. 
# This province91.srs.design object will be used for all subsequent analysis commands:
province91.srs.design &lt;- svydesign(ids = ~1, data = Sample, fpc = ~fpc, weights = ~weights)
paste(&quot;Estimates for the total of UE91 and LAB91 under simple random sampling without replacement (SRSWOR)&quot;)</code></pre>
<pre><code>## [1] &quot;Estimates for the total of UE91 and LAB91 under simple random sampling without replacement (SRSWOR)&quot;</code></pre>
<pre class="r"><code># Print the weighted total and standard error of the ue91 variable:
svytotal(~UE91, province91.srs.design)</code></pre>
<pre><code>##      total    SE
## UE91 26440 13282</code></pre>
<pre class="r"><code># Print the weighted total and standard error of the ue91 variable:
svytotal(~LAB91, province91.srs.design)</code></pre>
<pre><code>##        total     SE
## LAB91 206860 109763</code></pre>
<pre class="r"><code>paste(&quot;Estimates for the ratio of UE91/LAB91 under simple random sampling without replacement (SRSWOR)&quot;)</code></pre>
<pre><code>## [1] &quot;Estimates for the ratio of UE91/LAB91 under simple random sampling without replacement (SRSWOR)&quot;</code></pre>
<pre class="r"><code>svyratio(~UE91, ~LAB91, province91.srs.design)</code></pre>
<pre><code>## Ratio estimator: svyratio.survey.design2(~UE91, ~LAB91, province91.srs.design)
## Ratios=
##          LAB91
## UE91 0.1278159
## SEs=
##            LAB91
## UE91 0.004087265</code></pre>
<pre class="r"><code>confint(svyratio(~UE91, ~LAB91, province91.srs.design))</code></pre>
<pre><code>##               2.5 %    97.5 %
## UE91/LAB91 0.119805 0.1358268</code></pre>
<p>Selected SRSWOR sample and the estimates for the total of UE91 and
LAB91 and for the ratio UE91/LAB91 are similar to the results viewed in
table 2.4 on page 29 in Lehtonen and Pahkinen 2004. Pay attention to the
estimates and their standard errors and try to think why SRSWOR may lack
any significance for practical purposes according to this case
study.</p>
<p>After viewing the results, you can examine the R and SAS codes used
to calculate the estimates for the total of UE91 and LAB91 and for the
ratio UE91/LAB91. Then, you may move on to next step of Key 28 in which
different size SRSWOR samples will be selected to study how the sample
size affects to the total estimate and to the ratio estimate.</p>
</div>
<div id="b-srs-estimation-with-different-sample-sizes"
class="section level3">
<h3>B) SRS ESTIMATION WITH DIFFERENT SAMPLE SIZES</h3>
<p>In this exercise we examine SRSWOR estimation of the total of UE91
(number of unemployed in the province) and LAB91 (size of labour force
in the province) and of the ratio UE91/LAB91 by using different size
SRSWOR samples. The purpose is to examine how sample size (<span
class="math inline">\(n\)</span>) affects to the total estimate and to
the ratio estimate and their corresponding standard errors. We use
Province’91 data set as the frame population.</p>
<p><a href="Keys/key28/key28b_9.htm" target="_blank">Start SAS Training
Key</a></p>
<!-- NOTE: testing... content below tabbed region
-->
</div>
<div id="different-sample-sizes-n4816-or-32-of-srswor-sample"
class="section level2 tabset tabset-fade">
<h2 class="tabset tabset-fade">Different sample sizes (n=4,8,16 or 32)
of SRSWOR sample</h2>
<p>Select the desired sample size from the tab below and view the
results.</p>
<div id="n4" class="section level3">
<h3>n=4</h3>
<p>SRSWOR estimation for the total of UE91 and LAB91 and for the ratio
UE91/LAB91 with different sample sizes</p>
<p>Province91 Population, Sample size = 4</p>
<pre class="r"><code># load packages
library(sampling)
library(survey)

# create function to select different size SRSWOR samples with user defined seed number
srs &lt;- function(n, seed){
  print(&quot;Sample size is&quot;)
  print(n)
  set.seed(seed)
  # select a sample
  sampleprovince &lt;- srswor(n,32)
  # the sample is
  (1:32)[sampleprovince==1]
  # selected data
  srs_sampledata &lt;- getdata(province91, sampleprovince)
  print(&quot;Selected sample is&quot;)
  print(srs_sampledata)
  srs_sampledata$fpc &lt;- 32
  srs_sampledata$weights &lt;- (1/(n/32))
  # define design object
  province91.srs.design &lt;- svydesign(ids = ~1, data = srs_sampledata, fpc = ~fpc, weights = ~weights)
  print(&quot;Estimate for the total of UE91 is&quot;)
  print(svytotal(~UE91, province91.srs.design))
  print(&quot;Estimate for the total of LAB91 is&quot;)
  print(svytotal(~LAB91, province91.srs.design))
  print(&quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;)
  print(svyratio(~UE91, ~LAB91, province91.srs.design))
  print(confint(svyratio(~UE91, ~LAB91, province91.srs.design)))
}
# Function srs(n, seed)
# Give sample size (n) and select your own seed number (seed). Call function srs().
srs(4,123)</code></pre>
<pre><code>## [1] &quot;Sample size is&quot;
## [1] 4
## [1] &quot;Selected sample is&quot;
##   ID_unit Stratum Cluster Id Municipality POP91 LAB91 UE91 HOU85 URB85
## 1      14       2       8 14    Kivijärvi  1972   819  128   634     0
## 2      15       2       3 15 Konginkangas  1636   675  142   556     0
## 3      19       2       4 19     Kyyjärvi  1977   831   94   672     0
## 4      31       2       7 31     Uurainen  3004  1330  219   932     0
## [1] &quot;Estimate for the total of UE91 is&quot;
##      total     SE
## UE91  4664 790.67
## [1] &quot;Estimate for the total of LAB91 is&quot;
##       total     SE
## LAB91 29240 4286.6
## [1] &quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;
## Ratio estimator: svyratio.survey.design2(~UE91, ~LAB91, province91.srs.design)
## Ratios=
##          LAB91
## UE91 0.1595075
## SEs=
##           LAB91
## UE91 0.01540906
##                2.5 %    97.5 %
## UE91/LAB91 0.1293063 0.1897087</code></pre>
</div>
<div id="n8" class="section level3">
<h3>n=8</h3>
<p>SRSWOR estimation for the total of UE91 and LAB91 and for the ratio
UE91/LAB91 with different sample sizes</p>
<p>Province91 Population, Sample size = 8</p>
<pre class="r"><code># load packages
library(sampling)
library(survey)

# create function to select different size SRSWOR samples with user defined seed number
srs &lt;- function(n, seed){
  print(&quot;Sample size is&quot;)
  print(n)
  set.seed(seed)
  # select a sample
  sampleprovince &lt;- srswor(n,32)
  # the sample is
  (1:32)[sampleprovince==1]
  # selected data
  srs_sampledata &lt;- getdata(province91, sampleprovince)
  print(&quot;Selected sample is&quot;)
  print(srs_sampledata)
  srs_sampledata$fpc &lt;- 32
  srs_sampledata$weights &lt;- (1/(n/32))
  # define design object
  province91.srs.design &lt;- svydesign(ids = ~1, data = srs_sampledata, fpc = ~fpc, weights = ~weights)
  print(&quot;Estimate for the total of UE91 is&quot;)
  print(svytotal(~UE91, province91.srs.design))
  print(&quot;Estimate for the total of LAB91 is&quot;)
  print(svytotal(~LAB91, province91.srs.design))
  print(&quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;)
  print(svyratio(~UE91, ~LAB91, province91.srs.design))
  print(confint(svyratio(~UE91, ~LAB91, province91.srs.design)))
}
# Function srs(n, seed)
# Give sample size (n) and select your own seed number (seed). Call function srs().
srs(8,123)</code></pre>
<pre><code>## [1] &quot;Sample size is&quot;
## [1] 8
## [1] &quot;Selected sample is&quot;
##   ID_unit Stratum Cluster Id Municipality POP91 LAB91 UE91 HOU85 URB85
## 1       3       1       2  3  Jämsänkoski  8118  3818  528  3019     1
## 2      10       2       7 10    Jyväskmlk 29349 13727 1623  9230     0
## 3      14       2       8 14    Kivijärvi  1972   819  128   634     0
## 4      15       2       3 15 Konginkangas  1636   675  142   556     0
## 5      18       2       2 18    Kuhmoinen  3357  1448  187  1463     0
## 6      19       2       4 19     Kyyjärvi  1977   831   94   672     0
## 7      22       2       6 22      Luhanka  1153   522   54   435     0
## 8      31       2       7 31     Uurainen  3004  1330  219   932     0
## [1] &quot;Estimate for the total of UE91 is&quot;
##      total     SE
## UE91 11900 5155.2
## [1] &quot;Estimate for the total of LAB91 is&quot;
##       total    SE
## LAB91 92680 44107
## [1] &quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;
## Ratio estimator: svyratio.survey.design2(~UE91, ~LAB91, province91.srs.design)
## Ratios=
##          LAB91
## UE91 0.1283988
## SEs=
##            LAB91
## UE91 0.006582346
##                2.5 % 97.5 %
## UE91/LAB91 0.1154976 0.1413</code></pre>
</div>
<div id="n16" class="section level3">
<h3>n=16</h3>
<p>SRSWOR estimation for the total of UE91 and LAB91 and for the ratio
UE91/LAB91 with different sample sizes</p>
<p>Province91 Population, Sample size = 16</p>
<pre class="r"><code># load packages
library(sampling)
library(survey)

# create function to select different size SRSWOR samples with user defined seed number
srs &lt;- function(n, seed){
  print(&quot;Sample size is&quot;)
  print(n)
  set.seed(seed)
  # select a sample
  sampleprovince &lt;- srswor(n,32)
  # the sample is
  (1:32)[sampleprovince==1]
  # selected data
  srs_sampledata &lt;- getdata(province91, sampleprovince)
  print(&quot;Selected sample is&quot;)
  print(srs_sampledata)
  srs_sampledata$fpc &lt;- 32
  srs_sampledata$weights &lt;- (1/(n/32))
  # define design object
  province91.srs.design &lt;- svydesign(ids = ~1, data = srs_sampledata, fpc = ~fpc, weights = ~weights)
  print(&quot;Estimate for the total of UE91 is&quot;)
  print(svytotal(~UE91, province91.srs.design))
  print(&quot;Estimate for the total of LAB91 is&quot;)
  print(svytotal(~LAB91, province91.srs.design))
  print(&quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;)
  print(svyratio(~UE91, ~LAB91, province91.srs.design))
  print(confint(svyratio(~UE91, ~LAB91, province91.srs.design)))
}
# Function srs(n, seed)
# Give sample size (n) and select your own seed number (seed). Call function srs().
srs(16,123)</code></pre>
<pre><code>## [1] &quot;Sample size is&quot;
## [1] 16
## [1] &quot;Selected sample is&quot;
##    ID_unit Stratum Cluster Id Municipality POP91 LAB91 UE91 HOU85 URB85
## 1        3       1       2  3  Jämsänkoski  8118  3818  528  3019     1
## 2        5       1       3  5   Saarijärvi 10774  4930  721  3730     1
## 3        9       2       6  9       Joutsa  4594  2069  194  1823     0
## 4       10       2       7 10    Jyväskmlk 29349 13727 1623  9230     0
## 5       11       2       4 11  Kannonkoski  1919   821  153   726     0
## 6       14       2       8 14    Kivijärvi  1972   819  128   634     0
## 7       15       2       3 15 Konginkangas  1636   675  142   556     0
## 8       18       2       2 18    Kuhmoinen  3357  1448  187  1463     0
## 9       19       2       4 19     Kyyjärvi  1977   831   94   672     0
## 10      20       2       5 20       Laukaa 16042  7218  874  4952     0
## 11      22       2       6 22      Luhanka  1153   522   54   435     0
## 12      23       2       7 23       Multia  2375  1059  119   925     0
## 13      28       2       3 28    Sumiainen  1426   617   79   485     0
## 14      29       2       1 29   Säynätsalo  3628  1615  166  1226     0
## 15      30       2       6 30     Toivakka  2499  1084  127   834     0
## 16      31       2       7 31     Uurainen  3004  1330  219   932     0
## [1] &quot;Estimate for the total of UE91 is&quot;
##      total     SE
## UE91 10816 2366.5
## [1] &quot;Estimate for the total of LAB91 is&quot;
##       total    SE
## LAB91 85166 19719
## [1] &quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;
## Ratio estimator: svyratio.survey.design2(~UE91, ~LAB91, province91.srs.design)
## Ratios=
##         LAB91
## UE91 0.126999
## SEs=
##            LAB91
## UE91 0.003543583
##                2.5 %    97.5 %
## UE91/LAB91 0.1200537 0.1339443</code></pre>
</div>
<div id="n32" class="section level3">
<h3>n=32</h3>
<p>SRSWOR estimation for the total of UE91 and LAB91 and for the ratio
UE91/LAB91 with different sample sizes</p>
<p>Province91 Population, Sample size = 16</p>
<pre class="r"><code># load packages
library(sampling)
library(survey)

# create function to select different size SRSWOR samples with user defined seed number
srs &lt;- function(n, seed){
  print(&quot;Sample size is&quot;)
  print(n)
  set.seed(seed)
  # select a sample
  sampleprovince &lt;- srswor(n,32)
  # the sample is
  (1:32)[sampleprovince==1]
  # selected data
  srs_sampledata &lt;- getdata(province91, sampleprovince)
  print(&quot;Selected sample is&quot;)
  print(srs_sampledata)
  srs_sampledata$fpc &lt;- 32
  srs_sampledata$weights &lt;- (1/(n/32))
  # define design object
  province91.srs.design &lt;- svydesign(ids = ~1, data = srs_sampledata, fpc = ~fpc, weights = ~weights)
  print(&quot;Estimate for the total of UE91 is&quot;)
  print(svytotal(~UE91, province91.srs.design))
  print(&quot;Estimate for the total of LAB91 is&quot;)
  print(svytotal(~LAB91, province91.srs.design))
  print(&quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;)
  print(svyratio(~UE91, ~LAB91, province91.srs.design))
  print(confint(svyratio(~UE91, ~LAB91, province91.srs.design)))
}
# Function srs(n, seed)
# Give sample size (n) and select your own seed number (seed). Call function srs().
srs(32,123)</code></pre>
<pre><code>## [1] &quot;Sample size is&quot;
## [1] 32
## [1] &quot;Selected sample is&quot;
##    ID_unit Stratum Cluster Id Municipality POP91 LAB91 UE91 HOU85 URB85
## 1        1       1       1  1    Jyväskylä 67200 33786 4123 26881     1
## 2        2       1       2  2        Jämsä 12907  6016  666  4663     1
## 3        3       1       2  3  Jämsänkoski  8118  3818  528  3019     1
## 4        4       1       2  4       Keuruu 12707  5919  760  4896     1
## 5        5       1       3  5   Saarijärvi 10774  4930  721  3730     1
## 6        6       1       5  6     Suolahti  6159  3022  457  2389     1
## 7        7       1       3  7    Äänekoski 11595  5823  767  4264     1
## 8        8       2       5  8   Hankasalmi  6080  2594  391  2179     0
## 9        9       2       6  9       Joutsa  4594  2069  194  1823     0
## 10      10       2       7 10    Jyväskmlk 29349 13727 1623  9230     0
## 11      11       2       4 11  Kannonkoski  1919   821  153   726     0
## 12      12       2       4 12     Karstula  5594  2521  341  1868     0
## 13      13       2       8 13      Kinnula  2324   927  129   675     0
## 14      14       2       8 14    Kivijärvi  1972   819  128   634     0
## 15      15       2       3 15 Konginkangas  1636   675  142   556     0
## 16      16       2       5 16    Konnevesi  3453  1557  201  1215     0
## 17      17       2       1 17   Korpilahti  5181  2144  239  1793     0
## 18      18       2       2 18    Kuhmoinen  3357  1448  187  1463     0
## 19      19       2       4 19     Kyyjärvi  1977   831   94   672     0
## 20      20       2       5 20       Laukaa 16042  7218  874  4952     0
## 21      21       2       6 21   Leivonmäki  1370   573   61   545     0
## 22      22       2       6 22      Luhanka  1153   522   54   435     0
## 23      23       2       7 23       Multia  2375  1059  119   925     0
## 24      24       2       1 24      Muurame  6830  3024  296  1853     0
## 25      25       2       7 25   Petäjävesi  3800  1737  262  1352     0
## 26      26       2       8 26   Pihtipudas  5654  2543  331  1946     0
## 27      27       2       4 27   Pylkönmäki  1266   545   98   473     0
## 28      28       2       3 28    Sumiainen  1426   617   79   485     0
## 29      29       2       1 29   Säynätsalo  3628  1615  166  1226     0
## 30      30       2       6 30     Toivakka  2499  1084  127   834     0
## 31      31       2       7 31     Uurainen  3004  1330  219   932     0
## 32      32       2       8 32   Viitasaari  8641  4011  568  3119     0
## [1] &quot;Estimate for the total of UE91 is&quot;
##      total SE
## UE91 15098  0
## [1] &quot;Estimate for the total of LAB91 is&quot;
##        total SE
## LAB91 119325  0
## [1] &quot;Estimate for the ratio of UE91/LAB91 and confidence interval is&quot;
## Ratio estimator: svyratio.survey.design2(~UE91, ~LAB91, province91.srs.design)
## Ratios=
##          LAB91
## UE91 0.1265284
## SEs=
##      LAB91
## UE91     0
##                2.5 %    97.5 %
## UE91/LAB91 0.1265284 0.1265284</code></pre>
</div>
</div>
<div id="section" class="section level2">
<h2></h2>
<div
id="c-simulating-srswor-samples-by-using-monte-carlo-simulation-techniques"
class="section level3">
<h3>C) SIMULATING SRSWOR SAMPLES BY USING MONTE CARLO SIMULATION
TECHNIQUES</h3>
<p>Monte Carlo simulations are performed to examine the behavior of the
SRSWOR estimator.</p>
<p><a href="Keys/key28/key28c.htm" target="_blank">Start SAS Training
Key</a></p>
</div>
</div>
<div
id="simulation-experiments-for-srswor-estimator-for-the-total-of-ue91"
class="section level2 tabset tabset-fade">
<h2 class="tabset tabset-fade">Simulation Experiments for SRSWOR
estimator for the total of UE91</h2>
<p>Select the desired sample size from the tab below and view the
simulation results.</p>
<div id="n4-1" class="section level3">
<h3>n=4</h3>
<p>Sample size 4, Simulations 1000</p>
<table>
<caption><strong>Simulation Experiments for SRSWOR estimator for the
total of UE91.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15448.77</td>
<td align="right">11228.39</td>
<td align="right">350.768</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="n8-1" class="section level3">
<h3>n=8</h3>
<p>Sample size 8, Simulations 1000</p>
<table>
<caption><strong>Simulation Experiments for SRSWOR estimator for the
total of UE91.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15232.58</td>
<td align="right">7281.658</td>
<td align="right">134.58</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="n16-1" class="section level3">
<h3>n=16</h3>
<p>Sample size 16, Simulations 1000</p>
<table>
<caption><strong>Simulation Experiments for SRSWOR estimator for the
total of UE91.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15252.28</td>
<td align="right">4265.515</td>
<td align="right">154.276</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="n24" class="section level3">
<h3>n=24</h3>
<p>Sample size 24, Simulations 1000</p>
<table>
<caption><strong>Simulation Experiments for SRSWOR estimator for the
total of UE91.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15247.58</td>
<td align="right">2368.397</td>
<td align="right">149.584</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="section-1" class="section level2">
<h2></h2>
</div>
</div>
<div
id="training-key-45-intra-class-correlation-for-systematic-sampling"
class="section level1">
<h1>TRAINING KEY 45: Intra-class correlation for systematic
sampling</h1>
<div id="introduction-1" class="section level3">
<h3>INTRODUCTION</h3>
<p>In this Training Key we use the <a
href="concepts/concepts.html">Province’91 data set</a> as the frame
population in calculating the intra-class correlation coefficient under
<a href="concepts/concepts.html">systematic sampling</a>. The total of
the study variable UE91 (number of unemployed in the province) is to be
estimated. In Part A, the book example will be worked out. The effect of
different sorting orders of the population on the intra-class
correlation will be examined in Part B. Part C provides an option for
interactive analysis.</p>
</div>
<div
id="a-intra-class-correlation-for-systematic-sampling-in-the-province91-population"
class="section level3">
<h3>A) INTRA-CLASS CORRELATION FOR SYSTEMATIC SAMPLING IN THE
PROVINCE’91 POPULATION</h3>
<p>We calculate the intra-class correlation coefficient for systematic
sampling involving four separate systematic samples of eight elements
(see book example 2.4 on page 45). Further instructions will be given
once you start.</p>
<p><a href="Keys/key45/key45a.htm" target="_blank">Start SAS Training
Key, NOT COMPLETED: a html file is missing</a></p>
<p>For the Province’91 population, four separate systematic samples of
eight elements <span class="math inline">\((q=N/n=32/8=4)\)</span> are
drawn from the population data set. The total of the study variable UE91
(number of unemployed in the province) is to be estimated.</p>
<p>In systematic sampling, a certain design parameter exists. This
parameter, called the intra-class correlation coefficient <span
class="math inline">\(\rho_{int}\)</span>, will be included in the
design variance <span class="math inline">\(V_{sys}\)</span> of an
estimator of the population total. The magnitude of the intra-class
correlation, and consequently its effect on variance estimates, depends
partly on whether there is a successive system of ordering of the study
variable values in the population frame. The effect of sorting order is
examined in Part B of this training key.</p>
<p>To calculate the intra-class correlation, the population variance is
decomposed into the variation between the systematic samples and the
variation within the systematic samples, as in standard one-way analysis
of variance. In ANOVA terms we have <span class="math inline">\(SST =
SSW + SSB\)</span>, where <span class="math inline">\(SST\)</span>
represents the total sum of squares, <span
class="math inline">\(SSW\)</span> the within sum of squares and <span
class="math inline">\(SSB\)</span> the between sum of squares. By using
the decomposition of the total sum of squares, the intra-class
correlation is defined as <span class="math inline">\(\rho_{int} = 1 -
\frac{n}{(n-1)} \times \frac{SSW}{SST}\)</span>.</p>
<p>Systematic sampling compared with simple random sampling without
replacement is</p>
<ol style="list-style-type: lower-roman">
<li>more efficient, if <span class="math inline">\(\frac{-1}{(n-1)} &lt;
\rho_{int} &lt; 0\)</span>,</li>
<li>equally efficient, if <span class="math inline">\(\rho_{int} =
0\)</span> or</li>
<li>less efficient, if <span class="math inline">\(0 &lt; \rho_{int}
&lt; 1\)</span>.</li>
</ol>
<p>In this exercise the intra-class correlation is negative (-0.08)
which means that given the current sorting order of the population,
systematic sampling will be more efficient than simple random sampling
without replacement (SRSWOR). Note that the population was pre-sorted
first by the variable URB85 (urbanicity) and within each URB85 class, by
the variable Municipality for this exercise.</p>
<pre class="r"><code>paste(&quot;Load frame Population data set Province&#39;91:&quot;)</code></pre>
<pre><code>## [1] &quot;Load frame Population data set Province&#39;91:&quot;</code></pre>
<pre class="r"><code>load(&quot;province91.Rdata&quot;)</code></pre>
<p>Create four systematic samples: sample1, …, sample4.</p>
<pre class="r"><code>sample1 &lt;- province91[c(1,5,9,13,17,21,25,29), ]
paste(&quot;sample1 from population Province&#39;91:&quot;); sample1</code></pre>
<pre><code>## [1] &quot;sample1 from population Province&#39;91:&quot;</code></pre>
<pre><code>## # A tibble: 8 × 9
##   Stratum Cluster    Id Municipality POP91 LAB91  UE91 HOU85 URB85
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1       1     1 Jyväskylä    67200 33786  4123 26881     1
## 2       1       3     5 Saarijärvi   10774  4930   721  3730     1
## 3       2       6     9 Joutsa        4594  2069   194  1823     0
## 4       2       8    13 Kinnula       2324   927   129   675     0
## 5       2       1    17 Korpilahti    5181  2144   239  1793     0
## 6       2       6    21 Leivonmäki    1370   573    61   545     0
## 7       2       7    25 Petäjävesi    3800  1737   262  1352     0
## 8       2       1    29 Säynätsalo    3628  1615   166  1226     0</code></pre>
<pre class="r"><code>sample2 &lt;- province91[c(2,6,10,14,18,22,26,30), ]
paste(&quot;sample2 from population Province&#39;91:&quot;); sample2</code></pre>
<pre><code>## [1] &quot;sample2 from population Province&#39;91:&quot;</code></pre>
<pre><code>## # A tibble: 8 × 9
##   Stratum Cluster    Id Municipality POP91 LAB91  UE91 HOU85 URB85
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1       2     2 Jämsä        12907  6016   666  4663     1
## 2       1       5     6 Suolahti      6159  3022   457  2389     1
## 3       2       7    10 Jyväskmlk    29349 13727  1623  9230     0
## 4       2       8    14 Kivijärvi     1972   819   128   634     0
## 5       2       2    18 Kuhmoinen     3357  1448   187  1463     0
## 6       2       6    22 Luhanka       1153   522    54   435     0
## 7       2       8    26 Pihtipudas    5654  2543   331  1946     0
## 8       2       6    30 Toivakka      2499  1084   127   834     0</code></pre>
<pre class="r"><code>sample3 &lt;- province91[c(3,7,11,15,19,23,27,31), ]
paste(&quot;sample3 from population Province&#39;91:&quot;); sample3</code></pre>
<pre><code>## [1] &quot;sample3 from population Province&#39;91:&quot;</code></pre>
<pre><code>## # A tibble: 8 × 9
##   Stratum Cluster    Id Municipality POP91 LAB91  UE91 HOU85 URB85
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1       2     3 Jämsänkoski   8118  3818   528  3019     1
## 2       1       3     7 Äänekoski    11595  5823   767  4264     1
## 3       2       4    11 Kannonkoski   1919   821   153   726     0
## 4       2       3    15 Konginkangas  1636   675   142   556     0
## 5       2       4    19 Kyyjärvi      1977   831    94   672     0
## 6       2       7    23 Multia        2375  1059   119   925     0
## 7       2       4    27 Pylkönmäki    1266   545    98   473     0
## 8       2       7    31 Uurainen      3004  1330   219   932     0</code></pre>
<pre class="r"><code>sample4 &lt;- province91[c(4,8,12,16,20,24,28,32), ]
paste(&quot;sample4 from population Province&#39;91:&quot;); sample4</code></pre>
<pre><code>## [1] &quot;sample4 from population Province&#39;91:&quot;</code></pre>
<pre><code>## # A tibble: 8 × 9
##   Stratum Cluster    Id Municipality POP91 LAB91  UE91 HOU85 URB85
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1       2     4 Keuruu       12707  5919   760  4896     1
## 2       2       5     8 Hankasalmi    6080  2594   391  2179     0
## 3       2       4    12 Karstula      5594  2521   341  1868     0
## 4       2       5    16 Konnevesi     3453  1557   201  1215     0
## 5       2       5    20 Laukaa       16042  7218   874  4952     0
## 6       2       1    24 Muurame       6830  3024   296  1853     0
## 7       2       3    28 Sumiainen     1426   617    79   485     0
## 8       2       8    32 Viitasaari    8641  4011   568  3119     0</code></pre>
<pre class="r"><code># add sample IDs
sample1$sampleID &lt;- 1
sample2$sampleID &lt;- 2
sample3$sampleID &lt;- 3
sample4$sampleID &lt;- 4

# combine data sets
s &lt;- rbind(sample1, sample2, sample3, sample4)

library(samplesize4surveys)
icc &lt;- ICC(y = s$UE91, cl = s$sampleID)
paste(&quot;Intra-class correlation is&quot;); icc$ICC</code></pre>
<pre><code>## [1] &quot;Intra-class correlation is&quot;</code></pre>
<pre><code>## [1] -0.08161488</code></pre>
<p>The design effect is calculated by equation (2.24): <span
class="math inline">\(DEFF_{sys}(\hat{t}) =
\frac{V_{sys}(\hat{t})}{V_{srs}(\hat{t})} = 1 + (n-1) \times
\rho_{int}\)</span>.</p>
<pre class="r"><code># Design effect
n &lt;- nrow(sample1)
DEFF &lt;- 1 + (n-1)*icc$ICC
paste(&quot;Design effect is&quot;); DEFF</code></pre>
<pre><code>## [1] &quot;Design effect is&quot;</code></pre>
<pre><code>## [1] 0.4286958</code></pre>
<p>In this exercise the design effect is DEFF=0.43 which implies that
systematic sampling is very efficient in this case.</p>
<p>Further, we can write the design variance of the total estimator in
the form</p>
<p><span class="math inline">\(V_{sys}(\hat{t}) = N^2 \times (1 -
\frac{n}{N}) \times \frac{S^2}{n} \times [1 +
(n-1)\rho_{int}]\)</span></p>
<p>or alternatively</p>
<p><span class="math inline">\(V_{sys}(\hat{t}) = V_{srs}(\hat{t})
\times [1 + (n-1)\rho_{int}]\)</span>, as is given in equation
(2.23).</p>
<p>This also implies that systematic sampling is more efficient than
SRSWOR when rhoint is negative.</p>
</div>
<div
id="b-intra-class-correlation-for-systematic-sampling-when-varying-the-sorting-order"
class="section level3">
<h3>B) INTRA-CLASS CORRELATION FOR SYSTEMATIC SAMPLING WHEN VARYING THE
SORTING ORDER</h3>
<p>We examine the effect of the sorting order of the Province’91
population on intra-class correlation. It will be shown that the sorting
order matters: the value of the intra-class correlation coefficient
varies much depending on the sorting order. Further instructions will be
given once you start.</p>
<p><a href="Keys/key45/key45b.htm" target="_blank">Start SAS Training
Key</a></p>
<p>For the Province’91 population, four separate systematic samples of
eight elements <span class="math inline">\((q=N/n=32/8=4)\)</span> are
drawn from the population data set similarly as in Part A. The total of
the study variable UE91 (number of unemployed in the province) is to be
estimated.</p>
<p>We now examine the effect of the sorting order of the population
elements on the intra-class correlation coefficient. In sorting, we use
the available auxiliary information on the population. The following
sorting orders are developed:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Sorting by the variable URB85 (urbanicity in 1985), used in Part
A</p></li>
<li><p>Sorting by the variable HOU85 (the number of households in
1985)</p></li>
<li><p>Sorting by the variable HOU85 (the number of households in 1985)
and permuting</p></li>
<li><p>Sorting in random order by using a sequence of generated random
numbers.</p></li>
</ol>
<p>Sorting the population by one or several auxiliary variables before a
systematic sample is drawn is sometimes called “implicit stratification”
and is frequently used in practical application of systematic
sampling.</p>
<p>E.g. results and code for sorting order d) (Sorting in random order
by using a sequence of generated random numbers) is following. Try to
change the sort variable (see code chunk below).</p>
<pre class="r"><code>load(&quot;province91.Rdata&quot;)

# add random number for sorting
set.seed(123) # Pick a personal seed number
Random &lt;- runif(nrow(province91), min = 0, max = 1)
province91 &lt;- cbind(province91, Random)

# select variable for sorting (e.g. variable Random) and sort data 
province91.sorted &lt;- province91[order(province91$Random),]
# try sorting by URB85 and HOU85 variables:
# province91.sorted &lt;- province91[order(province91$URB85),]
# province91.sorted &lt;- province91[order(province91$HOU85),]

# Create four systematic samples from sorted data 
sample1 &lt;- province91.sorted[c(1,5,9,13,17,21,25,29), ]
sample2 &lt;- province91.sorted[c(2,6,10,14,18,22,26,30), ]
sample3 &lt;- province91.sorted[c(3,7,11,15,19,23,27,31), ]
sample4 &lt;- province91.sorted[c(4,8,12,16,20,24,28,32), ]

# HOU85 in descending order + &quot;optimal&quot; permutation:
#sample1 &lt;- filter(province91, Id %in% c(1,19,14,15,21,28,27,22))
#sample2 &lt;- filter(province91, Id %in% c(10,29,16,31,23,30,11,13))
#sample3 &lt;- filter(province91, Id %in% c(20,26,12,24,9,17,18,25))
#sample4 &lt;- filter(province91, Id %in% c(4,2,7,5,32,3,6,8))

# add sample IDs
sample1$sampleID &lt;- 1
sample2$sampleID &lt;- 2
sample3$sampleID &lt;- 3
sample4$sampleID &lt;- 4

# combine data sets
s &lt;- rbind(sample1, sample2, sample3, sample4)

library(samplesize4surveys)
icc &lt;- ICC(y = s$UE91, cl = s$sampleID)
paste(&quot;Intra-class correlation is:&quot;)</code></pre>
<pre><code>## [1] &quot;Intra-class correlation is:&quot;</code></pre>
<pre class="r"><code>icc$ICC</code></pre>
<pre><code>## [1] -0.05633341</code></pre>
<pre class="r"><code># Design effect
n &lt;- nrow(sample1)
paste(&quot;Design effect is:&quot;)</code></pre>
<pre><code>## [1] &quot;Design effect is:&quot;</code></pre>
<pre class="r"><code>(DEFF &lt;- 1 + (n-1)*icc$ICC)</code></pre>
<pre><code>## [1] 0.6056661</code></pre>
<p>In a), we use the same sorting order as in Part A. Calculated
approximative DEFF=0.426 indicates that the list order of the
municipalities (sorting first by URB85 and then by the name of the
municipality) is interestingly associated with the number of unemployed,
UE91. In b), we use HOU85 as sorting variable. Note that the variable
HOU85 correlates strongly with the study variable UE91. In b), the
population of municipalities is sorted in descending order by HOU85.
Surprisingly, the design effect is DEFF=0.531 which results in less
efficient systematic sampling as in case a. Again in c) we start with
descending order of HOU85 and in addition we introduce an “optimal”
permutation of units within sampling intervals. This results in
DEFF=0.25.<br />
As a reference in d), where we aim at a randomly ordered population with
respect to the study variable UE91, any substantial gain cannot be
expected, as indicated by a design effect close to one and systematic
sampling is almost equally efficient as SRSWOR.</p>
<p>We next illustrate in more detail the effect of the sorting order on
the efficiency of systematic sampling. The next table gives the means of
the study variable for each sample configuration under the sorting
orders. It can be clearly seen that in c) the means are closest to each
other and therefore, the intra-cluster correlation is the smallest.</p>
<table>
<thead>
<tr class="header">
<th>Systematic samples</th>
<th>a)</th>
<th>b)</th>
<th>c)</th>
<th>d)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sample 1</td>
<td>736.88</td>
<td>781.75</td>
<td>597.38</td>
<td>345.88</td>
</tr>
<tr class="even">
<td>Sample 2</td>
<td>446.63</td>
<td>462.13</td>
<td>342.13</td>
<td>799.63</td>
</tr>
<tr class="odd">
<td>Sample 3</td>
<td>265.00</td>
<td>337.38</td>
<td>340.50</td>
<td>466.88</td>
</tr>
<tr class="even">
<td>Sample 4</td>
<td>438.75</td>
<td>306.00</td>
<td>607.25</td>
<td>274.88</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\rho_{int}\)</span></td>
<td>-0.082</td>
<td>-0.067</td>
<td>-0.106</td>
<td>-0.056</td>
</tr>
<tr class="even">
<td>DEFF</td>
<td>0.426</td>
<td>0.531</td>
<td>0.255</td>
<td>0.606</td>
</tr>
</tbody>
</table>
<p>Note that the intra-class correlation coefficient is negative in all
example cases which means that given the different sorting orders
examined, systematic sampling in these cases is more efficient than
simple random sampling without replacement (SRSWOR).</p>
<p>Note also that results in d) depend on the choice of the seed number
for the generation of the sequence of random numbers. This is because we
now have no control over the composition of the sampling intervals and
our population size happens to be small. In this example the seed is 123
and it produces a DEFF 0.606. If a different seed number is chosen,
different results will be obtained (see the table below).</p>
<p>The effect of seed number to intra-class correlation and DEFF:</p>
<table>
<thead>
<tr class="header">
<th>Seed number</th>
<th><span class="math inline">\(\rho_{int}\)</span></th>
<th>DEFF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>98765432</td>
<td>-0.0004478304</td>
<td>0.9968652</td>
</tr>
<tr class="even">
<td>654326599</td>
<td>0.0509257</td>
<td>1.35648</td>
</tr>
<tr class="odd">
<td>11111111</td>
<td>-0.06489158</td>
<td>0.545759</td>
</tr>
</tbody>
</table>
</div>
<div id="c-interactive-sas-use" class="section level3">
<h3>C) INTERACTIVE SAS USE</h3>
<p>Please download the SAS code for your own further training.
Instructions are given in the SAS code once you download. NOTE! You need
to have access to SAS in your computer.</p>
<p><a href="Keys/key45/key45a.sas" target="_blank">Download SAS code,
Key45a.sas</a></p>
<p><a href="Keys/key45/key45b.sas" target="_blank">Download SAS code,
Key45b.sas</a></p>
</div>
</div>
<div
id="training-key-54-the-use-of-auxiliary-information-in-pps-sampling"
class="section level1">
<h1>TRAINING KEY 54: The use of auxiliary information in PPS
sampling</h1>
<div id="introduction-2" class="section level3">
<h3>INTRODUCTION</h3>
<p>In point A we will show how to perform estimation under <a
href="concepts/concepts.html">systematic PPS sampling (PPSSYS)</a>.
Point A refers to example 2.6 (page 54). In point B we will demonstrate
how the use of <a href="concepts/concepts.html">auxiliary
information</a> affects to the total estimate of UE91 (number of
unemployed in the province) and the corresponding variance estimate.
This is to get familiar on the selection and use of auxiliary
information in <a href="concepts/concepts.html">PPS sampling</a>. Point
C is an option for interactive analysis. We use Province’91 data set as
the frame population.</p>
</div>
<div
id="a-reference-example-2.6-estimation-under-systematic-pps-sampling"
class="section level3">
<h3>A) REFERENCE EXAMPLE 2.6: Estimation under systematic PPS
sampling</h3>
<p>Systematic PPS sample <span class="math inline">\((n=8)\)</span> is
drawn from the <a href="concepts/concepts.html">Province’91
population</a> such that the number of households (HOU85) is used as the
size measure <span class="math inline">\(z\)</span>. PPSSYS estimate and
the corresponding standard error estimate are calculated from the
selected sample. The results are compared to estimation under <a
href="concepts/concepts.html">SRSWOR sampling</a>.</p>
<p><a href="Keys/key54/key54a.htm" target="_blank">Start SAS Trainig
Key</a></p>
<p>In Province’91 population the cumulative sum of HOU85 over the
population is 91753 and under systematic PPS sampling the sampling
interval would be <span class="math inline">\(q=91753/8=11469\)</span>.
However, the largest element ‘Jyvaskylä’ has the value 26881 for the
variable, which is more than twice the sampling interval. Therefore, the
element would be drawn twice and the remaining 6 elements would be drawn
from the remaining population elements. In this case, therefore, we
first take the largest element ‘Jyväskylä’ with certainty and then draw
7 elements from the remaining population elements by systematic PPS
sampling. Such a situation is commonly managed in the way described
above.</p>
<p>Please view the R code to examine how the study is performed.</p>
<pre class="r"><code>load(&quot;province91.Rdata&quot;)
Sample.srs &lt;- filter(province91, Id %in% c(1,4,7,10,13,18,26,32))
Sample.pps &lt;- filter(province91, Id %in% c(1,4,7,10,13,18,26,32))

# Add indicator variable for Jyväskylä
Sample.pps$Jystrat &lt;- 1
Sample.pps$Jystrat[Sample.pps$Id %in% c(4,7,10,13,18,26,32)] &lt;- 2
# NOTE: In each strata we need at least two observations. Because Jyväskylä is sampled with certainty, Jyväskylä is entered 
# twice in our sample data file and the weight for Jyväskylä is 0.5 per observation line.  
jyv &lt;- Sample.pps[1,]
Sample.pps &lt;- rbind(Sample.pps, jyv) # Jyväskylä is now twice in our data

# package survey
library(survey)
# total=32:  fpc = finite population correction: fpc = (1-n/N)
# This column (variable) fpc simply contains the number 32 for every record.
Sample.srs$fpc &lt;- 32
Sample.srs$weights &lt;- 4
# Sampling weight calculation for PPS (the cumulative sum of HOU85 over the population is 91753 and the largest element Jyväskylä has the value 26881)
# sum(province91$HOU85)
# sum(province91$HOU85) - 26881 
Sample.pps$weights_pps &lt;- (91753-26881)/(Sample.pps$HOU85*7)
Sample.pps$weights_pps[Sample$Id==1] &lt;- 0.5

# define design objects
province91.srs.design &lt;- svydesign(ids = ~1,  data = Sample.srs, fpc = ~fpc, weights = ~weights)
province91.pps.design &lt;- svydesign(ids = ~Id, data = Sample.pps, strata = ~Jystrat, weights = ~weights_pps)

t.ue91.srs  &lt;- svytotal(~UE91, province91.srs.design)
paste(&quot;SRSWOR estimation for the total of UE91 and its&#39; se:&quot;)</code></pre>
<pre><code>## [1] &quot;SRSWOR estimation for the total of UE91 and its&#39; se:&quot;</code></pre>
<pre class="r"><code>t.ue91.srs</code></pre>
<pre><code>##      total    SE
## UE91 33952 12976</code></pre>
<pre class="r"><code># Note. svytotal doesn&#39;t work without some adjustment to options (see more: http://r-survey.r-forge.r-project.org/survey/exmample-lonely.html)
options(survey.lonely.psu = &quot;certainty&quot;)
t.ue91.pps  &lt;- svytotal(~UE91, province91.pps.design)
paste(&quot;PPSSYS estimation for the total of UE91 and its&#39; se:&quot;)</code></pre>
<pre><code>## [1] &quot;PPSSYS estimation for the total of UE91 and its&#39; se:&quot;</code></pre>
<pre class="r"><code>t.ue91.pps</code></pre>
<pre><code>##      total     SE
## UE91 15078 521.33</code></pre>
</div>
<div
id="b-the-use-of-alternative-auxiliary-information-in-ppswor-sampling"
class="section level3">
<h3>B) THE USE OF ALTERNATIVE AUXILIARY INFORMATION IN PPSWOR
SAMPLING</h3>
<p>We use three different auxiliary variables in <a
href="concepts/concepts.html">PPSWOR</a> sampling. The first auxiliary
variable is HOU85 (the number of households in the municipality). The
two others are artificial variables x and z. These variables are
constructed for pedagogical purposes to demonstrate the role of
correlation of the study variable and auxiliary variable, and that a
strong correlation alone does not guarantee good efficiency for PPSWOR.
Further instructions are given once you start.</p>
<p><a href="Keys/key54/key54b.htm" target="_blank">Start SAS Training
Key</a></p>
</div>
<div
id="simulation-experiments-the-use-of-alternative-auxiliary-information-in-ppswor-sampling"
class="section level2 tabset tabset-fade">
<h2 class="tabset tabset-fade">Simulation Experiments: the use of
alternative auxiliary information in PPSWOR sampling</h2>
<p>Select the desired size measure variable from the tab below and view
the simulation results. Size variables that you can select are:</p>
<ol style="list-style-type: decimal">
<li>HOU85 (number of households in a municipality)</li>
<li>Z (artificially created variable for pedagogical purposes,
N(500,150))</li>
<li>X (artificially created variable for pedagogical purposes, UE91 +
3000)</li>
</ol>
<div id="hou85" class="section level3">
<h3>HOU85</h3>
<table>
<caption><strong>Simulation Experiments for PPS estimator for the total
of UE91. Size variable HOU85, Sample size 8, Simulations
1000.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15118.36</td>
<td align="right">455.1317</td>
<td align="right">20.36347</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="z" class="section level3">
<h3>Z</h3>
<table>
<caption><strong>Simulation Experiments for PPS estimator for the total
of UE91. Size variable Z, Sample size 8, Simulations
1000.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">14732.96</td>
<td align="right">8192.497</td>
<td align="right">365.0374</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="x" class="section level3">
<h3>X</h3>
<table>
<caption><strong>Simulation Experiments for PPS estimator for the total
of UE91. Size variable X, Sample size 8, Simulations
1000.</strong></caption>
<thead>
<tr class="header">
<th align="right">Population_Total</th>
<th align="right">Mean_of_Estimates</th>
<th align="right">Std_error</th>
<th align="right">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15098</td>
<td align="right">15175.88</td>
<td align="right">4296.628</td>
<td align="right">77.88458</td>
</tr>
</tbody>
</table>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
<div id="section-2" class="section level2">
<h2></h2>
<div id="c-interactive-sas-use-1" class="section level3">
<h3>C) INTERACTIVE SAS USE</h3>
<p>Please download the SAS code for your own further training. Further
instructions are given once you download the code.</p>
<p>NOTE! You need to have access to SAS in your computer.</p>
<p><a href="Keys/key54/sasmacro54.sas" target="_blank">Download SAS
code</a></p>
</div>
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further Reading</h1>
<div id="chapter-2-further-reading" class="section level3">
<h3>Chapter 2: Further Reading</h3>
<div id="training-key-28-analysing-an-srs-sample-1"
class="section level4">
<h4>TRAINING KEY 28: Analysing an SRS sample</h4>
<ul>
<li>Cochran W.G. (1977). Sampling Techniques. 3rd edition. New York:
Wiley. (Chapters 1-5)</li>
</ul>
</div>
<div
id="training-key-54-the-use-of-auxiliary-information-in-pps-sampling-1"
class="section level4">
<h4>TRAINING KEY 54: The use of auxiliary information in PPS
sampling</h4>
<ul>
<li>Brewer, K.R.W. and Hanif, M. (1983). Sampling with Unequal
Probabilities. New York: Springer.</li>
<li>Hedayat, A.S. and Sinha, B.K. (1991). Finite Population Sampling.
New York: Wiley.</li>
</ul>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
